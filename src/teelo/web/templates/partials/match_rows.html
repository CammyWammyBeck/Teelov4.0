{% macro tour_bg(tour) %}
{% if tour == 'ATP' %}bg-[#002865]{% elif tour in ['WTA', 'WTA 125', 'WTA_125'] %}bg-[#E30066]{% elif tour in ['CHALLENGER', 'Challenger'] %}bg-[#006B3F]{% else %}bg-gray-600{% endif %}
{% endmacro %}

{% macro tour_label(tour) %}
{% if tour in ['CHALLENGER', 'Challenger'] %}CHL{% elif tour in ['WTA 125', 'WTA_125'] %}125{% else %}{{ tour or '?' }}{% endif %}
{% endmacro %}

{% macro surface_cls(surface) %}
{% if surface == 'Hard' %}text-[#3B82F6]{% elif surface == 'Clay' %}text-[#EA580C]{% elif surface == 'Grass' %}text-green-600{% endif %}
{% endmacro %}

{% macro render_table_rows(matches) %}
{% for m in matches %}
{% set is_winner_a = m.winner_id == m.player_a.id %}
{% set is_winner_b = m.winner_id == m.player_b.id %}
<tr class="hover:bg-gray-50/50 transition-colors duration-75 group border-l-4 border-transparent hover:border-teelo-lime">
    <td class="px-5 py-3">
        <div class="flex items-center gap-2">
            <span class="{{ tour_bg(m.tour) }} text-white text-[10px] px-1.5 py-0.5 rounded font-bold tracking-tight flex-shrink-0">{{ tour_label(m.tour) }}</span>
            <div class="min-w-0">
                <span class="text-sm font-semibold text-teelo-dark truncate block" title="{{ m.tournament_name or 'Unknown' }}">{{ m.tournament_name or 'Unknown' }}</span>
                <span class="text-xs text-gray-400">{{ m.round or '' }} 路 {{ m.tournament_level or '' }} 路 <span class="{{ surface_cls(m.surface) }}">{{ m.surface or '' }}</span></span>
            </div>
        </div>
    </td>
    <td class="px-5 py-3 text-right">
        <div class="flex items-center justify-end gap-2">
            <span class="text-sm {% if is_winner_a %}text-teelo-dark font-bold{% else %}text-gray-400{% endif %}">{{ m.player_a.name }}</span>
            {% if is_winner_a %}
            <i data-lucide="check" class="w-3.5 h-3.5 text-teelo-lime flex-shrink-0"></i>
            {% endif %}
        </div>
    </td>
    <td class="px-5 py-3 text-center">
        <span class="inline-block px-2.5 py-1 bg-gray-50 rounded-md text-xs font-mono text-teelo-dark font-semibold whitespace-nowrap group-hover:bg-teelo-lime/10 transition-colors">{{ m.score or '' }}</span>
    </td>
    <td class="px-5 py-3">
        <div class="flex items-center gap-2">
            {% if is_winner_b %}
            <i data-lucide="check" class="w-3.5 h-3.5 text-teelo-lime flex-shrink-0"></i>
            {% endif %}
            <span class="text-sm {% if is_winner_b %}text-teelo-dark font-bold{% else %}text-gray-400{% endif %}">{{ m.player_b.name }}</span>
        </div>
    </td>
    <td class="px-5 py-3 text-right">
        <span class="text-xs text-gray-400 whitespace-nowrap">{{ m.match_date_display or '' }}</span>
    </td>
</tr>
{% endfor %}
{% endmacro %}

{% macro render_cards(matches) %}
{% for m in matches %}
{% set is_winner_a = m.winner_id == m.player_a.id %}
{% set is_winner_b = m.winner_id == m.player_b.id %}
<div class="px-4 py-3 hover:bg-gray-50/50 transition-colors">
    <div class="flex items-center justify-between mb-2">
        <div class="flex items-center gap-2 min-w-0">
            <span class="{{ tour_bg(m.tour) }} text-white text-[10px] px-1.5 py-0.5 rounded font-bold tracking-tight flex-shrink-0">{{ tour_label(m.tour) }}</span>
            <span class="text-sm font-semibold text-teelo-dark truncate">{{ m.tournament_name or 'Unknown' }}</span>
        </div>
        <span class="text-xs text-gray-400 flex-shrink-0 ml-2">{{ m.match_date_display or '' }}</span>
    </div>
    <div class="text-xs text-gray-400 mb-2.5 pl-[42px]">{{ m.round or '' }} 路 {{ m.tournament_level or '' }} 路 <span class="{{ surface_cls(m.surface) }}">{{ m.surface or '' }}</span></div>
    <div class="flex items-center gap-3 pl-[42px]">
        <div class="flex-1 min-w-0">
            <div class="flex items-center gap-1.5 {% if is_winner_a %}text-teelo-dark font-bold{% else %}text-gray-400{% endif %} text-sm">
                {% if is_winner_a %}<i data-lucide="check" class="w-3.5 h-3.5 text-teelo-lime flex-shrink-0"></i>{% endif %}
                <span class="truncate">{{ m.player_a.name }}</span>
            </div>
            <div class="flex items-center gap-1.5 {% if is_winner_b %}text-teelo-dark font-bold{% else %}text-gray-400{% endif %} text-sm mt-0.5">
                {% if is_winner_b %}<i data-lucide="check" class="w-3.5 h-3.5 text-teelo-lime flex-shrink-0"></i>{% endif %}
                <span class="truncate">{{ m.player_b.name }}</span>
            </div>
        </div>
        <span class="px-2.5 py-1 bg-gray-50 rounded-md text-xs font-mono text-teelo-dark font-semibold whitespace-nowrap flex-shrink-0">{{ m.score or '' }}</span>
    </div>
</div>
{% endfor %}
{% endmacro %}
